import Head from "next/head";
import React, { useEffect } from "react";
import Link from "next/link";
import PokemonListContainer from "../container/PokemonListContainer";
import styled from "@emotion/styled";
import Layout from "../container/Layout";
import Header from "../components/Header";
import MainContainer from "../container/MainContainer";
import FixedMainContainer from "../container/FixedMainContainer";
import { useQuery } from "@apollo/client";
import { GET_POKEMONS } from "../graphql/apis";
import { useAppContext } from "../context/state";

export default function Home() {
    const state = useAppContext();

    const { loading, error, data } = useQuery(GET_POKEMONS, {
        variables: {
            limit: 10,
            offset: 0,
        },
    });

    useEffect(() => {
        if (data) state.setPokemons(data.pokemons.results);
    }, [data]);
    return (
        <Layout>
            <Head>
                <title>Create Next App</title>
                <meta name="description" content="Generated by create next app" />
            </Head>
            <Header />
            <MainContainer>
                <FixedMainContainer>
                    <PokemonListContainer data={data} />
                </FixedMainContainer>
            </MainContainer>

            <Link href="/pokemons/test">link</Link>
        </Layout>
    );
}
